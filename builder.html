<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Builder - PolyBot Builder</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="builder.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="builder-page">
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <button class="sidebar-logo" title="PolyBot Builder">
                <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect width="32" height="32" rx="8" fill="url(#gradient)"/>
                    <path d="M16 8L24 12V20L16 24L8 20V12L16 8Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 16L24 12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 16V24" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M16 16L8 12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <defs>
                        <linearGradient id="gradient" x1="0" y1="0" x2="32" y2="32">
                            <stop offset="0%" stop-color="#00FFA3"/>
                            <stop offset="100%" stop-color="#00B8D4"/>
                        </linearGradient>
                    </defs>
                </svg>
            </button>
            <button class="sidebar-toggle-btn" onclick="toggleSidebar()" title="Toggle sidebar">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="6" height="14" rx="1"/>
                    <path d="M10 6h7M10 10h7M10 14h7"/>
                </svg>
            </button>
        </div>

        <div class="sidebar-actions">
            <button class="sidebar-action-item" onclick="newChat()" title="New chat">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 10h12M10 4v12"/>
                </svg>
                <span class="sidebar-label">New chat</span>
            </button>
            <button class="sidebar-action-item" onclick="searchChats()" title="Search chats">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="9" r="6"/>
                    <path d="M13.5 13.5l4 4"/>
                </svg>
                <span class="sidebar-label">Search chats</span>
            </button>
        </div>

        <div class="chat-list" id="chatList">
            <!-- Chats will be dynamically added here -->
        </div>

        <div class="sidebar-footer">
            <button class="sidebar-menu-item" onclick="openSettings()">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="10" cy="10" r="3"/>
                    <path d="M10 1v2M10 17v2M19 10h-2M3 10H1M16.5 16.5l-1.4-1.4M4.9 4.9L3.5 3.5M16.5 3.5l-1.4 1.4M4.9 15.1l-1.4 1.4"/>
                </svg>
                <span class="sidebar-label">Settings</span>
            </button>
            <button class="sidebar-menu-item" onclick="openAccount()">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="10" cy="6" r="4"/>
                    <path d="M2 18a8 8 0 0116 0"/>
                </svg>
                <span class="sidebar-label">Account</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Sidebar Toggle (shown when sidebar is collapsed) -->
        <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                <line x1="3" y1="5" x2="17" y2="5"/>
                <line x1="3" y1="10" x2="17" y2="10"/>
                <line x1="3" y1="15" x2="17" y2="15"/>
            </svg>
        </button>

        <!-- Top Bar -->
        <div class="builder-topbar">
            <div class="topbar-left">
                <input type="text" id="botName" class="bot-name-input" placeholder="Untitled Bot" />
            </div>
            <div class="topbar-right">
                <label class="autosave-toggle">
                    <input type="checkbox" id="autosaveToggle" checked onchange="toggleAutosave(this.checked)">
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Autosave</span>
                </label>
                <button class="btn-secondary btn-small" onclick="saveDraft()">Save Draft</button>
                <button class="btn-primary btn-small" onclick="exportBot()">Export Bot</button>
            </div>
        </div>

        <!-- Builder Interface -->
        <div class="builder-container">
            <!-- Left Pane: Chat -->
            <div class="builder-pane chat-pane">
                <div class="chat-messages" id="chatMessages">
                    <div class="welcome-message">
                        <h2>Build Your Polymarket Trading Bot</h2>
                        <p>Describe your trading strategy in plain English. I'll generate the code for you.</p>
                        <div class="example-prompts">
                            <button class="example-prompt" onclick="useExample(this)">Create an arbitrage bot that monitors similar markets</button>
                            <button class="example-prompt" onclick="useExample(this)">Build a market maker with 2% spread</button>
                            <button class="example-prompt" onclick="useExample(this)">Make a news-driven bot for election markets</button>
                        </div>
                    </div>
                </div>
                <div class="chat-input-container">
                    <textarea
                        id="chatInput"
                        placeholder="Describe your trading strategy..."
                        rows="1"
                        onkeydown="handleChatKeydown(event)"
                        oninput="autoResizeTextarea(this)"
                    ></textarea>
                    <button class="btn-send" onclick="sendMessage()" id="sendButton">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M2 10l16-8-8 16-2-6-6-2z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Right Pane: Code -->
            <div class="builder-pane code-pane">
                <div class="pane-header">
                    <div class="header-tabs">
                        <button class="tab active" onclick="switchTab('code')">Code</button>
                        <button class="tab" onclick="switchTab('preview')">Preview</button>
                    </div>
                    <div class="code-actions">
                        <button class="btn-icon" onclick="copyCode()" title="Copy code">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="1.5">
                                <rect x="5" y="5" width="9" height="9" rx="1"/>
                                <path d="M3 11V3a1 1 0 011-1h8"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="code-content" id="codeContent">
                    <div class="code-placeholder">
                        <svg width="48" height="48" viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="16 18 22 24 16 30"/>
                            <polyline points="32 18 26 24 32 30"/>
                        </svg>
                        <p>Your bot code will appear here</p>
                        <span>Start by describing your strategy in the chat</span>
                    </div>
                </div>
                <div class="code-status">
                    <span class="status-indicator"></span>
                    <span class="status-text">Ready</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" onclick="renameChat()">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M7 2h5v5M12 2L5 9m-2 2l2-2"/>
            </svg>
            Rename
        </div>
        <div class="context-menu-item" onclick="pinChat()">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M7 2v6M4 5l3 3 3-3"/>
            </svg>
            Pin
        </div>
        <div class="context-menu-item danger" onclick="deleteChat()">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M2 4h10M5 4V2h4v2M3 4v8a1 1 0 001 1h6a1 1 0 001-1V4"/>
            </svg>
            Delete
        </div>
    </div>

    <script src="builder.js"></script>
</body>
</html>
